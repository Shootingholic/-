# 海量指纹库匹配任务加速机制设计
---
- **项目灵感来源**

    从各类现场或文件中所能提取到的指纹信息往往会伴随各种污点和损坏，影响指纹识别的效果和速度，为了解决该问题，许多研究都提出，可以先从原始图片中，通过卷积层的计算进行图片的特征提取获取指纹的方向场信息，再将该方向场信息做进一步的处理，比如协助图像增强和海量数据的预分类，加速在海量指纹库中与匹配到目标指纹的速度。此外，根据方向场信息，还可以对指纹进行预分类，分类结果可以作为分布式系统存储的索引依据，优化海量指纹数据库的存储，从而也能有效筛除大部分数据，加速检索速度。

- **项目主要内容**

    我们拟使用HLS对方向场的特征提取算法进行硬件加速设计，封装成IP核以后，设计在zynq芯片上的数据通路，并通过pynq便捷的overlay来编写加速器驱动。提取的方向场将与测试集的方向场进行相似度比较，以评估加速器加持下的模型精确度。

- **项目的预期成果**

    我们将通过网络开源的指纹数据库进行方向场提取，与传统的软件效果做比较，争取达到模型吞吐率的提升，以及精度的维持甚至提高。

## 项目开发过程中遇到的问题

1. 对于网络结构比较深的网络，怎么在有限的资源上进行整个网络的部署需要巧妙的设计，尽量重用计算资源。
2. 同样也是硬件BRAM资源的问题，权重就算再怎么进行量化，对于一些规模一般大的网络层来说，综合出来的报表都远远超过Pynq上的芯片的数量
3. 如果想在非Pynq的平台上使用这些加速核，还需要对驱动文件进行转换，要不就只能找能烧Pynq镜像的板子了
4. ......

## 项目完成情况
* 以[CNNIOT](https://github.com/mfarhadi/CNNIOT)为设计参考，我们构建了可以通过发送不同数据包头来实现不同网络层计算的cnn加速IP核。
* 以[Anguli](https://dsl.cds.iisc.ac.in/projects/Anguli/index.html#about)提供的指纹生成器所产生的指纹数据集，成功实现了方向场提取的功能
* 编写了能够展示方向场提取结果的软件程序，方便查看结果

## *if you want to try our demo*

### pre：有pynq-z2的运行环境

> 没有的话请参考Xilinx的官方文档或[PYNQ](https://github.com/Xilinx/PYNQ) GitHub上的环境搭建教程

1. 将demo文件夹拷贝到Pynq的jupyter运行目录下
2. 运行Fingernet_DF_FPGA.ipynb

---
## demo
- 可运行demo
- 文件说明
> Weights：权重文件

> Data：示例图片

> Bitstream.tcl : hw

> Bitstream.bit : hw

> Fingernet_DF_FPGA.ipynb : demo program

> CNNIOT.py : driver wrapper


## Doc
- 用于存放暑期学校相关提交文档

## Pic
- 用于存放结果展示照片

## Ref
- 用于存放参考资料，便于查阅。
---

*该项目为2020年新工科联盟-Xilinx暑期学校（Summer School）项目。*
